# 追蹤事項

## 待追蹤

### iPhone PWA 離線 "load failed" 問題
- **狀態**: 調查中
- **描述**: 電腦端離線邏輯正常，iPhone PWA 模式下出現 load failed，疑似 SW precache 或 iOS Safari 快取機制問題
- **已排除**: API 層邏輯正確（電腦端驗證通過）
- **可能原因**:
  - iOS Safari Service Worker 行為與 Chrome 不同
  - SW precache 的 JS bundle 過大（~5.3MB），iOS 可能有快取上限
  - iOS standalone 模式下 SW 生命週期差異
  - `navigateFallback` 在 iOS 上未正確攔截
- **下一步**: 用 iPhone Safari 的開發者工具（Mac Safari → 開發 → iPhone）查看 SW 狀態和 console log

## 已完成

- PWA 離線模式基礎架構（SW 註冊、manifest、workbox runtime caching）
- IndexedDB 離線提交佇列（Dexie）
- 表單快取至 IndexedDB（離線時從快取載入）
- 離線提交 fallback（網路錯誤 / 伺服器 5xx / 逾時 / DNS 不可達）
- 版本衝突偵測與處理（version_conflict 狀態 + UI 操作）
- 網路狀態指示器（離線/同步中/衝突/完成）
- Health check + 指數退避重試（5s/10s/30s/60s）
- 伺服器不可達時保持 pending 而非標 failed
